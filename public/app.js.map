{"version":3,"sources":["app/components/App.js","app/initialize.js"],"names":["headerHeight","headerStyle","position","top","left","right","height","iframeHolderStyle","bottom","iframeStyle","display","width","border","errorStyle","color","renderPreviewHTMLToIFrame","html","iframe","contentDocument","open","write","close","App","props","state","initialBoardID","onChangeBoardID","bind","onSetIFrame","window","potentialBoardID","location","hash","substring","checkBoardIDAndLoad","setState","navigatePreviewToPath","reloadFrame","boardID","get","then","routes","response","data","boardJSON","boardError","catch","error","input","trim","length","loadBoard","target","value","pathToFind","matchingRoute","find","path","output","handler","renderPath","message","Component","require","createElement","render","document","addEventListener","el","getElementById"],"mappings":"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","file":"public/app.js","sourcesContent":["import React from 'react'\nimport Axios from 'axios'\nimport { routesForTrelloData, promiseEnhancedTrelloCards } from 'lokum/lib/trello'\n\nconst headerHeight = '2rem'\n\nconst headerStyle = {\n\tposition: 'fixed',\n\ttop: 0,\n\tleft: 0,\n\tright: 0,\n\theight: headerHeight\n}\n\nconst iframeHolderStyle = {\n\tposition: 'absolute',\n\ttop: headerHeight,\n\tleft: 0,\n\tright: 0,\n\tbottom: 0\n}\n\nconst iframeStyle = {\n\tdisplay: 'block',\n\twidth: '100%',\n\theight: '100%',\n\tborder: 'none'\n}\n\nconst errorStyle = {\n\tcolor: 'red'\n}\n\nfunction renderPreviewHTMLToIFrame(html, iframe) {\n\tconst { contentDocument } = iframe\n\tcontentDocument.open()\n\tcontentDocument.write(html)\n\tcontentDocument.write(`\n<script>\nfunction hijackAClick(e) {\n\tconst target = e.currentTarget;\n\tif (target && target.pathname && target.host === location.host && target.pathname[0] === '/' && target.pathname[1] !== '/') {\n\t\tparent.navigatePreviewToPath(target.pathname);\n\t\tevent.preventDefault();\n\t\tevent.stopPropagation();\n\t}\n} \n\nvar links = document.getElementsByTagName('a');\nfor (var i = 0; i < links.length; i++) {\n\tlinks[i].addEventListener('click', hijackAClick)\n}\n</script>\n`)\n\tcontentDocument.close()\n}\n\nexport default class App extends React.Component {\n\tconstructor(props) {\n\t\tsuper(props)\n\n\t\tthis.state = {\n\t\t\tinitialBoardID: null\n\t\t}\n\n\t\tthis.onChangeBoardID = this.onChangeBoardID.bind(this)\n\t\tthis.onSetIFrame = this.onSetIFrame.bind(this)\n\t}\n\n\tcomponentWillMount() {\n\t\tif (window) {\n\t\t\tconst potentialBoardID = window.location.hash.substring(1)\n\t\t\tif (this.checkBoardIDAndLoad(potentialBoardID)) {\n\t\t\t\tthis.setState({ initialBoardID: potentialBoardID })\n\t\t\t}\n\t\t}\n\t}\n\n\tcomponentDidMount() {\n\t\twindow.navigatePreviewToPath = this.reloadFrame.bind(this)\n\t}\n\n\tcomponentWillUnmount() {\n\t\tdelete window.navigatePreviewToPath\n\t}\n\n\tloadBoard(boardID) {\n\t\tAxios.get(`https://trello.com/b/${ boardID }.json`)\n    .then(response => {\n\t\t\tconst routes = routesForTrelloData(response.data)\n\t\t\twindow.location.hash = `#${ boardID }`\n\t\t\tthis.setState({\n\t\t\t\tboardJSON: response.data,\n\t\t\t\tboardError: null,\n\t\t\t\troutes\n\t\t\t}, () => {\n\t\t\t\tthis.reloadFrame()\n\t\t\t})\n\t\t})\n\t\t.catch(error => {\n\t\t\tthis.setState({\n\t\t\t\tboardError: error\n\t\t\t})\n\t\t})\n\t}\n\n\tcheckBoardIDAndLoad(input) {\n\t\tinput = input.trim()\n\t\tif (input.length > 0) {\n\t\t\tthis.loadBoard(input)\n\t\t\treturn true\n\t\t}\n\n\t\treturn false\n\t}\n\n\tonChangeBoardID({ target }) {\n\t\tthis.checkBoardIDAndLoad(target.value)\n\t}\n\t\n\tonSetIFrame(iframe) {\n\t\tthis.iframe = iframe\n\t\tthis.reloadFrame()\n\t}\n\n\trenderPath(pathToFind) {\n\t\tconst { routes } = this.state\n\t\tif (!routes) {\n\t\t\treturn\n\t\t}\n\n\t\tconst matchingRoute = routes.find(({ path }) => path === pathToFind)\n\t\tif (!matchingRoute) {\n\t\t\treturn\n\t\t}\n\n\t\tlet output = ''\n\t\tmatchingRoute.handler({}, (html) => {\n\t\t\toutput = html\n\t\t})\n\n\t\treturn output\n\t}\n\n\treloadFrame(path = '/') {\n\t\tif (!this.iframe) {\n\t\t\treturn\n\t\t}\n\n\t\tconst { contentDocument } = this.iframe\n\n\t\tconst html = this.renderPath(path) || ''\n\t\trenderPreviewHTMLToIFrame(html, this.iframe)\n\t}\n\n\trender() {\n\t\tconst { initialBoardID, boardError } = this.state\n\n\t\treturn (\n\t\t\t<main>\n\t\t\t\t<header style={ headerStyle }>\n\t\t\t\t\tTrello Board ID:\n\t\t\t\t\t&nbsp;\n\t\t\t\t\t<input type=\"text\" defaultValue={ initialBoardID } onChange={ this.onChangeBoardID } />\n\t\t\t\t\t{ boardError && <p style={ errorStyle }>Error loading: { boardError.message }</p> }\n\t\t\t\t</header>\n\t\t\t\t<div style={ iframeHolderStyle }>\n\t\t\t\t\t<iframe ref={ this.onSetIFrame } style={ iframeStyle } />\n\t\t\t\t</div>\n\t\t\t</main>\n\t\t)\n\t}\n}","const { createElement } = require('react')\nconst { render } = require('react-dom')\nimport App from './components/App.js'\n\ndocument.addEventListener('DOMContentLoaded', function() {\n\tconst el = document.getElementById('app')\n\trender(createElement(App, null), el)\n})\n"]}